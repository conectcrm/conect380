# ============================================
# BANCO DE DADOS POSTGRESQL
# ============================================
DB_HOST=localhost
DB_PORT=5434
DB_USERNAME=postgres
DB_PASSWORD=sua-senha-aqui
DB_DATABASE=conectcrm

# ============================================
# JWT & AUTENTICAÇÃO
# ============================================
JWT_SECRET=sua-chave-secreta-jwt-super-segura-aqui
JWT_EXPIRATION=7d

# ============================================
# SERVIDOR
# ============================================
PORT=3000
NODE_ENV=development

# ============================================
# SSL/HTTPS (Produção)
# ============================================
SSL_ENABLED=false
# Definir como 'true' em produção com certificados SSL válidos

SSL_CERT_PATH=./certs/cert.pem
# Caminho para o certificado SSL (fullchain.pem do Let's Encrypt)

SSL_KEY_PATH=./certs/key.pem
# Caminho para a chave privada SSL (privkey.pem do Let's Encrypt)

FORCE_HTTPS=false
# Definir como 'true' para forçar HTTPS mesmo em development
# Em produção, sempre força HTTPS automaticamente

# ============================================
# CORS (Cross-Origin Resource Sharing)
# ============================================
CORS_ORIGINS=http://localhost:3000,https://app.conectcrm.com.br
# Lista separada por vírgulas das origens permitidas
# Produção: apenas domínios específicos (sem wildcard)
# Desenvolvimento: localhost será sempre permitido

CORS_ALLOW_PRIVATE_NETWORK=false
# Permite origens de rede local (192.168.x.x, 10.x.x.x, 172.16-31.x.x)
# Em desenvolvimento já é permitido automaticamente.
# Em produção, só habilite se realmente necessário.

# ============================================
# BACKUP AUTOMÁTICO (PostgreSQL)
# ============================================
ENABLE_BACKUP=true
# Habilita backup automático diário

BACKUP_RETENTION_DAILY=7
# Número de backups diários para manter

BACKUP_RETENTION_WEEKLY=4
# Número de backups semanais para manter

BACKUP_RETENTION_MONTHLY=12
# Número de backups mensais para manter

# Cloud Upload (Opcional)
ENABLE_S3_UPLOAD=false
S3_BUCKET=conectcrm-backups
S3_REGION=us-east-1

ENABLE_AZURE_UPLOAD=false
AZURE_STORAGE_ACCOUNT=conectcrmbackups
AZURE_CONTAINER=backups

# ============================================
# NOTIFICAÇÕES (Slack)
# ============================================
ENABLE_SLACK_NOTIFICATIONS=false
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL
# Webhook para notificações de backup, erros críticos, etc.

# ============================================
# MONITORAMENTO
# ============================================
ENABLE_SENTRY=false
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
# Sentry para tracking de erros em produção

ENABLE_UPTIME_MONITORING=false
UPTIME_CHECK_URL=https://uptime-monitor.com/check/conectcrm
# URL para enviar heartbeat (UptimeRobot, Pingdom, etc.)

# ============================================
# LOGGING (Winston)
# ============================================
LOG_LEVEL=info
# Níveis disponíveis: error, warn, info, http, verbose, debug, silly
# Produção: info ou warn
# Desenvolvimento: debug ou verbose

# ============================================
# REDIS (para BullMQ)
# ============================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
# REDIS_TLS=false  # Descomente para usar TLS (produção)

# ============================================
# OPENAI (OBRIGATÓRIO para IA)
# ============================================
OPENAI_API_KEY=sk-proj-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
OPENAI_MODEL=gpt-4o-mini
# Outros modelos disponíveis: gpt-4o, gpt-4, gpt-4-turbo, gpt-3.5-turbo
OPENAI_EMBEDDING_MODEL=text-embedding-3-small
OPENAI_MAX_TOKENS=2000
OPENAI_TEMPERATURE=0.7

# ============================================
# ANTHROPIC CLAUDE (OPCIONAL - alternativa à OpenAI)
# ============================================
ANTHROPIC_API_KEY=sk-ant-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ANTHROPIC_MODEL=claude-3-5-sonnet-20241022
# Outros modelos: claude-3-opus-20240229, claude-3-haiku-20240307
ANTHROPIC_MAX_TOKENS=2000

# ============================================
# WHATSAPP BUSINESS CLOUD API
# ============================================
# Obtenha em: https://developers.facebook.com/apps
WHATSAPP_PHONE_NUMBER_ID=123456789012345
WHATSAPP_ACCESS_TOKEN=EAAxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
WHATSAPP_WEBHOOK_VERIFY_TOKEN=seu-token-secreto-webhook-aqui
WHATSAPP_BUSINESS_ACCOUNT_ID=123456789012345

# ============================================
# TELEGRAM BOT (OPCIONAL)
# ============================================
# Crie um bot via @BotFather no Telegram
TELEGRAM_BOT_TOKEN=123456789:ABCdefGHIjklMNOpqrsTUVwxyz012345678

# ============================================
# TWILIO (OPCIONAL - SMS + WhatsApp)
# ============================================
# Obtenha em: https://www.twilio.com/console
TWILIO_ACCOUNT_SID=ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
TWILIO_AUTH_TOKEN=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
TWILIO_FROM=+5511999999999
# Para WhatsApp via Twilio (se usar):
TWILIO_WHATSAPP_NUMBER=whatsapp:+14155238886

# ============================================
# EMAIL - SENDGRID (OPCIONAL)
# ============================================
# Obtenha em: https://app.sendgrid.com/settings/api_keys
SENDGRID_API_KEY=SG.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
EMAIL_FROM=noreply@suaempresa.com
EMAIL_FROM_NAME=ConectCRM Suporte

# ============================================
# EMAIL - AWS SES (OPCIONAL - alternativa ao SendGrid)
# ============================================
SES_ACCESS_KEY_ID=AKIAxxxxxxxxxxxxxxxx
SES_SECRET_ACCESS_KEY=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
SES_REGION=us-east-1
SES_FROM=noreply@suaempresa.com

# ============================================
# EMAIL - SMTP GENÉRICO (OPCIONAL)
# ============================================
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=seu-email@gmail.com
SMTP_PASSWORD=sua-senha-ou-app-password
SMTP_FROM=noreply@suaempresa.com

# ============================================
# PUSH (Firebase Cloud Messaging)
# ============================================
# Projeto e credencial
FCM_PROJECT_ID=seu-projeto-firebase
# Opcional: JSON do service account como string (sem quebras de linha)
FCM_SERVICE_ACCOUNT_JSON={"type":"service_account","project_id":"seu-projeto-firebase","private_key_id":"...","private_key":"-----BEGIN PRIVATE KEY-----\\n...\\n-----END PRIVATE KEY-----\\n","client_email":"fcm@seu-projeto.iam.gserviceaccount.com","client_id":"123","auth_uri":"https://accounts.google.com/o/oauth2/auth","token_uri":"https://oauth2.googleapis.com/token","auth_provider_x509_cert_url":"https://www.googleapis.com/oauth2/v1/certs","client_x509_cert_url":"https://www.googleapis.com/robot/v1/metadata/x509/fcm%40seu-projeto.iam.gserviceaccount.com"}

# ============================================
# FRONTEND & CORS
# ============================================
FRONTEND_URL=http://localhost:3000
CORS_ORIGIN=http://localhost:3000,http://localhost:3001
# Para produção, especifique os domínios permitidos

# ============================================
# UPLOAD DE ARQUIVOS
# ============================================
MAX_FILE_SIZE=10485760
# 10MB em bytes
UPLOAD_DEST=./uploads
ALLOWED_FILE_TYPES=image/jpeg,image/png,image/gif,application/pdf,video/mp4

# ============================================
# WEBHOOK BASE URL (para callbacks)
# ============================================
# Em desenvolvimento: use ngrok ou localtunnel
WEBHOOK_BASE_URL=https://seu-dominio.com
# Exemplo com ngrok: https://abc123.ngrok.io

# ============================================
# ELASTICSEARCH (OPCIONAL - para busca avançada)
# ============================================
# ELASTICSEARCH_NODE=http://localhost:9200
# ELASTICSEARCH_USERNAME=elastic
# ELASTICSEARCH_PASSWORD=sua-senha-aqui

# ============================================
# LOGGING & MONITORAMENTO
# ============================================
LOG_LEVEL=debug
# Opções: error, warn, info, debug, verbose
LOG_FILE=./logs/app.log

# ============================================
# RATE LIMITING
# ============================================
RATE_LIMIT_TTL=60
# Tempo em segundos
RATE_LIMIT_MAX=100
# Máximo de requisições por TTL

# ============================================
# BULL BOARD (visualização de filas)
# ============================================
BULL_BOARD_ENABLED=true
BULL_BOARD_PATH=/admin/queues
# Acesse em: http://localhost:3000/admin/queues

# ============================================
# AI - CONFIGURAÇÕES AVANÇADAS
# ============================================
AI_SENTIMENT_THRESHOLD=0.7
# Confiança mínima para classificação de sentimento
AI_RAG_SIMILARITY_THRESHOLD=0.7
# Threshold para busca semântica (RAG)
AI_CHURN_THRESHOLD=0.8
# Threshold para alerta de churn
AI_AUTO_RESPONSE_ENABLED=false
# Ativar respostas automáticas da IA (experimental)

# ============================================
# ATENDIMENTO - CONFIGURAÇÕES
# ============================================
DEFAULT_SLA_MINUTES=30
# SLA padrão em minutos
MAX_TICKETS_PER_AGENT=10
# Máximo de tickets por atendente
AUTO_CLOSE_RESOLVED_HOURS=72
# Auto-fechar tickets resolvidos após X horas
INACTIVE_TICKET_HOURS=24
# Considerar ticket inativo após X horas sem resposta

# ============================================
# NOTIFICAÇÕES
# ============================================
NOTIFICATIONS_ENABLED=true
EMAIL_NOTIFICATIONS=true
PUSH_NOTIFICATIONS=false
# Para push: configurar Firebase/OneSignal
# ID do usuário que receberá alertas internos (breaker/backlog da fila notifications)
NOTIFICATIONS_ADMIN_USER_ID=
# (Opcional) empresa_id do usuário admin acima. Usado para executar jobs que gravam no banco sob o tenant correto.
NOTIFICATIONS_ADMIN_EMPRESA_ID=
# Telefone (E.164) para alertas externos críticos (SLA/backlog/breaker/tickets ALTA/URGENTE)
NOTIFICATIONS_ADMIN_PHONE=+5511999999999
# Limiar de backlog (waiting) para alertar na fila notifications (ex: 500)
NOTIFICATIONS_BACKLOG_THRESHOLD=500
# Fila notifications utiliza retry/backoff com jitter e breaker por jobName

# ============================================
# FEATURES FLAGS
# ============================================
FEATURE_AI_ENABLED=true
FEATURE_VOICE_CALLS=false
FEATURE_VIDEO_CALLS=false
FEATURE_CHATBOT=false
FEATURE_AUTO_TRANSLATION=false

# ============================================
# BACKUP & SEGURANÇA
# ============================================
# BACKUP_ENABLED=true
# BACKUP_SCHEDULE=0 2 * * *  # Diariamente às 2h
# BACKUP_RETENTION_DAYS=30
ENCRYPTION_KEY=chave-de-criptografia-256-bits-aqui
# Use: openssl rand -base64 32

# ============================================
# MÉTRICAS & ANALYTICS
# ============================================
# PROMETHEUS_ENABLED=false
# PROMETHEUS_PORT=9090
# GOOGLE_ANALYTICS_ID=UA-XXXXXXXXX-X

# ============================================
# SENTRY - ERROR TRACKING & MONITORING
# ============================================
# IMPORTANTE: Obter DSN em https://sentry.io → Settings → Projects → Client Keys (DSN)
SENTRY_DSN=https://YOUR_KEY@YOUR_ORG.ingest.sentry.io/YOUR_PROJECT_ID
ENABLE_SENTRY=false
# Mudar para 'true' em produção para habilitar captura de erros
# Em desenvolvimento: 100% sample rate (todos os erros + performance)
# Em produção: 10% sample rate (economia de quota Sentry)

# ============================================
# DESENVOLVIMENTO
# ============================================
# Apenas para desenvolvimento:
DEBUG_MODE=true
MOCK_EXTERNAL_APIS=false
# Se true, simula respostas das APIs externas
SKIP_WEBHOOKS_VERIFICATION=false
# NUNCA usar em produção!

# ============================================
# PRODUÇÃO (descomente para produção)
# ============================================
# NODE_ENV=production
# LOG_LEVEL=error
# DEBUG_MODE=false
# MOCK_EXTERNAL_APIS=false
# SKIP_WEBHOOKS_VERIFICATION=false
# RATE_LIMIT_MAX=1000

# ============================================
# PAGAMENTOS - GATEWAY FEATURE GATE
# ============================================
# Lista de providers habilitados por ambiente (separados por virgula)
# Valores aceitos: stripe, mercado_pago, pagseguro
PAGAMENTOS_GATEWAY_ENABLED_PROVIDERS=

# Bypass global (usar apenas em dev/homologacao)
# Em producao, mantenha false e habilite via lista acima
PAGAMENTOS_GATEWAY_ALLOW_UNIMPLEMENTED=false
